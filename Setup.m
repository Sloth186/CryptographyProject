(* ::Package:: *)

books = {3, 11, 43, 45, 76, 84, 98, 100, 145, 158, 174, 219,
345, 394, 408, 768, 844, 1080, 1184, 1232, 1259, 1260, 1342, 1400,
1513, 1661, 1952, 1998, 2000, 2160, 2542, 2554, 2591, 2600, 2641, 2701,
3207, 4085, 4300, 4363, 5197, 5200, 6593, 6761, 16389, 25344, 26184, 28054,
37106, 41445, 64317, 67979};


(* Extracts raw text for each book from Gutenberg *)
 text = {};
 Do[
 	(* Grab book text from Project Gutenberg and lowercase everything *)
 	bookText = ToLowerCase[Import[URL["https://www.gutenberg.org/cache/epub/" <> i <> "/pg" <> i <> ".txt"]]];
 	(* Split the text into words and add to existing list of text *)
 	text = Join[text, StringSplit[bookText, RegularExpression["[^a-z]+"]]]
 , {i, ToString /@ books}]
 numWords = Length[text];
 numChars = Plus @@ StringLength /@ text;


text
numWords
numChars


(* Counts the number of times each character appears across all text and sorts by said characters and divides by the total number of characters *)
monoFreqAll = KeySort[KeyMap[List, Map[#/numChars&, Counts[Characters[StringJoin[text]]]]]];
(* Obtains frequencies only for the standard 26 alphabetic letters *)
monoFreqAlpha = KeySelect[monoFreqAll, !MemberQ[LetterNumber[#], 0]&];


(* Bar chart to visualize monogram frequencies *)
BarChart[monoFreqAlpha, ChartLabels->StringJoin /@ Keys[monoFreqAlpha]]


(* ::Input:: *)
(*Graphics[{{Opacity[0], Point[{{0.10465116279069775`, 0.}, {26.380143112701248`, 0.}}]}, {{}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{0.6198568872987478, 0.}, {1.3801431127012522`, 0.0813348980435768}, RoundingRadius -> 0], Rational[1453314, 17868271]], Style[1453314/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{1.6198568872987478`, 0.}, {2.3801431127012522`, 0.015081313687261627`}, RoundingRadius -> 0], Rational[269477, 17868271]], Style[269477/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{2.6198568872987478`, 0.}, {3.3801431127012522`, 0.025048282511497617`}, RoundingRadius -> 0], Rational[895139, 35736542]], Style[895139/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{3.6198568872987478`, 0.}, {4.380143112701252, 0.04409743953402095}, RoundingRadius -> 0], Rational[787945, 17868271]], Style[787945/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{4.619856887298748, 0.}, {5.380143112701252, 0.12439354093073694`}, RoundingRadius -> 0], Rational[4445395, 35736542]], Style[4445395/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{5.619856887298748, 0.}, {6.380143112701252, 0.02139739765531875}, RoundingRadius -> 0], Rational[764669, 35736542]], Style[764669/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{6.619856887298748, 0.}, {7.380143112701252, 0.01934498866734224}, RoundingRadius -> 0], Rational[691323, 35736542]], Style[691323/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{7.619856887298748, 0.}, {8.380143112701251, 0.06116881706125903}, RoundingRadius -> 0], Rational[1092981, 17868271]], Style[1092981/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{8.619856887298747, 0.}, {9.380143112701251, 0.06831925707865076}, RoundingRadius -> 0], Rational[1220747, 17868271]], Style[1220747/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{9.619856887298747, 0.}, {10.380143112701251`, 0.0017045577605130345`}, RoundingRadius -> 0], Rational[60915, 35736542]], Style[60915/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{10.619856887298747`, 0.}, {11.380143112701251`, 0.0075007257277438875`}, RoundingRadius -> 0], Rational[134025, 17868271]], Style[134025/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{11.619856887298747`, 0.}, {12.380143112701251`, 0.04106608859917112}, RoundingRadius -> 0], Rational[733780, 17868271]], Style[733780/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{12.619856887298747`, 0.}, {13.380143112701251`, 0.026900979954915614`}, RoundingRadius -> 0], Rational[480674, 17868271]], Style[480674/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{13.619856887298747`, 0.}, {14.380143112701251`, 0.06872287755205862}, RoundingRadius -> 0], Rational[1227959, 17868271]], Style[1227959/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{14.619856887298747`, 0.}, {15.380143112701251`, 0.07870361379676859}, RoundingRadius -> 0], Rational[2812595, 35736542]], Style[2812595/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{15.619856887298747`, 0.}, {16.38014311270125, 0.017143908327783924`}, RoundingRadius -> 0], Rational[306332, 17868271]], Style[306332/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{16.619856887298745`, 0.}, {17.380143112701248`, 0.0019270191279279344`}, RoundingRadius -> 0], Rational[68865, 35736542]], Style[68865/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{17.619856887298745`, 0.}, {18.380143112701248`, 0.05918434973367037}, RoundingRadius -> 0], Rational[1057522, 17868271]], Style[1057522/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{18.619856887298745`, 0.}, {19.380143112701248`, 0.06350726379737581}, RoundingRadius -> 0], Rational[1134765, 17868271]], Style[1134765/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{19.619856887298745`, 0.}, {20.380143112701248`, 0.0874995683689821}, RoundingRadius -> 0], Rational[1563466, 17868271]], Style[1563466/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{20.619856887298745`, 0.}, {21.380143112701248`, 0.030323275262614944`}, RoundingRadius -> 0], Rational[1083649, 35736542]], Style[1083649/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{21.619856887298745`, 0.}, {22.380143112701248`, 0.010155067605589818`}, RoundingRadius -> 0], Rational[362907, 35736542]], Style[362907/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{22.619856887298745`, 0.}, {23.380143112701248`, 0.022214544429060876`}, RoundingRadius -> 0], Rational[793871, 35736542]], Style[793871/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{23.619856887298745`, 0.}, {24.380143112701248`, 0.0014731139907157218`}, RoundingRadius -> 0], Rational[26322, 17868271]], Style[26322/17868271, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{24.619856887298745`, 0.}, {25.380143112701248`, 0.021027580116733176`}, RoundingRadius -> 0], Rational[751453, 35736542]], Style[751453/35736542, {}]]}, {RGBColor[1., 0.78, 0.2], EdgeForm[{Opacity[0.518], Thickness[Small]}], Tooltip[StatusArea[Rectangle[{25.619856887298745`, 0.}, {26.380143112701248`, 0.0007595306787097644}, RoundingRadius -> 0], Rational[27143, 35736542]], Style[27143/35736542, {}]]}}, {}, {}}, {}, {}, {}, {}, Style[Style[{{Thickness[Tiny], Line[{{0.10465116279069775`, 0.}, {26.905652951699462`, 0.}}], Style[{}, "GraphicsLabel", StripOnInput -> False]}, Style[{{Thickness[Tiny], Line[{{0.6198568872987478, 0.}, Offset[{-1.102182119232618*^-15, -6.}, {0.6198568872987478, 0.}]}], Line[{{26.38014311270125, 0.}, Offset[{-1.102182119232618*^-15, -6.}, {26.38014311270125, 0.}]}], {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {Line[{{1.3801431127012522`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {1.3801431127012522`, 0.}]}], Line[{{1.6198568872987478`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {1.6198568872987478`, 0.}]}], Line[{{2.3801431127012522`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {2.3801431127012522`, 0.}]}], Line[{{2.6198568872987478`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {2.6198568872987478`, 0.}]}], Line[{{3.3801431127012522`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {3.3801431127012522`, 0.}]}], Line[{{3.6198568872987478`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {3.6198568872987478`, 0.}]}], Line[{{4.380143112701252, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {4.380143112701252, 0.}]}], Line[{{4.619856887298748, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {4.619856887298748, 0.}]}], Line[{{5.380143112701252, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {5.380143112701252, 0.}]}], Line[{{5.619856887298748, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {5.619856887298748, 0.}]}], Line[{{6.380143112701252, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {6.380143112701252, 0.}]}], Line[{{6.619856887298748, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {6.619856887298748, 0.}]}], Line[{{7.380143112701252, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {7.380143112701252, 0.}]}], Line[{{7.619856887298748, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {7.619856887298748, 0.}]}], Line[{{8.380143112701251, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {8.380143112701251, 0.}]}], Line[{{8.619856887298747, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {8.619856887298747, 0.}]}], Line[{{9.380143112701251, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {9.380143112701251, 0.}]}], Line[{{9.619856887298745, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {9.619856887298745, 0.}]}], Line[{{10.380143112701251`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {10.380143112701251`, 0.}]}], Line[{{10.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {10.619856887298745`, 0.}]}], Line[{{11.380143112701251`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {11.380143112701251`, 0.}]}], Line[{{11.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {11.619856887298745`, 0.}]}], Line[{{12.380143112701251`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {12.380143112701251`, 0.}]}], Line[{{12.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {12.619856887298745`, 0.}]}], Line[{{13.380143112701251`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {13.380143112701251`, 0.}]}], Line[{{13.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {13.619856887298745`, 0.}]}], Line[{{14.380143112701251`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {14.380143112701251`, 0.}]}], Line[{{14.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {14.619856887298745`, 0.}]}], Line[{{15.380143112701251`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {15.380143112701251`, 0.}]}], Line[{{15.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {15.619856887298745`, 0.}]}], Line[{{16.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {16.38014311270125, 0.}]}], Line[{{16.619856887298745`, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {16.619856887298745`, 0.}]}], Line[{{17.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {17.38014311270125, 0.}]}], Line[{{17.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {17.61985688729875, 0.}]}], Line[{{18.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {18.38014311270125, 0.}]}], Line[{{18.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {18.61985688729875, 0.}]}], Line[{{19.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {19.38014311270125, 0.}]}], Line[{{19.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {19.61985688729875, 0.}]}], Line[{{20.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {20.38014311270125, 0.}]}], Line[{{20.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {20.61985688729875, 0.}]}], Line[{{21.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {21.38014311270125, 0.}]}], Line[{{21.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {21.61985688729875, 0.}]}], Line[{{22.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {22.38014311270125, 0.}]}], Line[{{22.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {22.61985688729875, 0.}]}], Line[{{23.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {23.38014311270125, 0.}]}], Line[{{23.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {23.61985688729875, 0.}]}], Line[{{24.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {24.38014311270125, 0.}]}], Line[{{24.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {24.61985688729875, 0.}]}], Line[{{25.38014311270125, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {25.38014311270125, 0.}]}], Line[{{25.61985688729875, 0.}, Offset[{-7.347880794884119*^-16, -4.}, {25.61985688729875, 0.}]}]}, {}}}, Style[{Thickness[Tiny], Inset["a", Offset[{0, -2}, {1., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["b", Offset[{0, -2}, {2., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["c", Offset[{0, -2}, {3., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["d", Offset[{0, -2}, {4., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["e", Offset[{0, -2}, {5., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["f", Offset[{0, -2}, {6., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["g", Offset[{0, -2}, {7., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["h", Offset[{0, -2}, {7.999999999999999, 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["i", Offset[{0, -2}, {9., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["j", Offset[{0, -2}, {10., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["k", Offset[{0, -2}, {11., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["l", Offset[{0, -2}, {12., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["m", Offset[{0, -2}, {13., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["n", Offset[{0, -2}, {14., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["o", Offset[{0, -2}, {15., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["p", Offset[{0, -2}, {16., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["q", Offset[{0, -2}, {17., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["r", Offset[{0, -2}, {18., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["s", Offset[{0, -2}, {19., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["t", Offset[{0, -2}, {20., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["u", Offset[{0, -2}, {21., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["v", Offset[{0, -2}, {22., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["w", Offset[{0, -2}, {23., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["x", Offset[{0, -2}, {24., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["y", Offset[{0, -2}, {25., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}], Inset["z", Offset[{0, -2}, {26., 0.}], ImageScaled[{Rational[1, 2], 1}], Automatic, {1, 0}]}, "GraphicsLabel", StripOnInput -> False]}, "GraphicsTicks", StripOnInput -> False]}, Antialiasing -> False], "GraphicsAxes", StripOnInput -> False]}, AspectRatio -> GoldenRatio^(-1), Axes -> {False, True}, AxesLabel -> {None, None}, AxesOrigin -> {0.10465116279069775`, 0.}, CoordinatesToolOptions :> {"DisplayFunction" -> ({Identity[Part[#, 1]], Identity[Part[#, 2]]}& ), "CopiedValueFunction" -> ({Identity[Part[#, 1]], Identity[Part[#, 2]]}& )}, DisplayFunction -> Identity, FrameLabel -> {{None, None}, {None, None}}, FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, GridLines -> {None, None}, GridLinesStyle -> Directive[GrayLevel[0.5, 0.4]], ImageSize -> {427.2, Automatic}, PlotRange -> {{All, All}, {All, All}}, PlotRangePadding -> {{Scaled[0.02], Scaled[0.02]}, {Scaled[0.02], Scaled[0.05]}}, Ticks -> {None, Automatic}]*)


(* Convert each word in the text to a list of characters *)
(* Select only the lists that have strictly more than 1 element - in other words, drop 1-letter words *)
(* Obtain all bigrams for each word *)
(* The above produces a list of lists, so flatten at the first level to make counting easier *)
bigrams = Flatten[Subsequences[#, {2}]& /@ Select[Characters[text], Length[#]>1&], 1]


(* Count the frequency of each digram, divided by the total number of bigrams *)
biFreqAll = KeySort[Map[#/Length[bigrams]&, Counts[bigrams]]];
(* Keep only digrams containing strictly alphabetical characters *)
biFreqAlpha = KeySelect[biFreqAll, !MemberQ[LetterNumber[#], 0]&];


(* Visualize the top 25 digrams *)
top25biFreqAlpha = Sort[biFreqAlpha, Greater][[1;;25]]
BarChart[top25biFreqAlpha, ChartLabels->StringJoin/@Keys[top25biFreqAlpha]]


(* Convert each word in the text to a list of characters *)
(* Select only the lists that have strictly more than 2 elements - in other words, drop 1-letter and 2-letter words *)
(* Obtain all trigrams for each word *)
(* The above produces a list of lists, so flatten at the first level to make counting easier *)
trigrams = Flatten[Subsequences[#, {3}]& /@ Select[Characters[text], Length[#]>2&], 1]


(* Count the frequency of each trigram, divided by the total number of trigrams *)
triFreqAll = KeySort[Map[#/Length[trigrams]&, Counts[trigrams]]];
(* Keep only trigrams containing strictly alphabetical characters *)
triFreqAlpha = KeySelect[triFreqAll, !MemberQ[LetterNumber[#], 0]&];


(* Convert each word in the text to a list of characters *)
(* Select only the lists that have strictly more than 3 elements - in other words, drop 1-letter, 2-letter, and 3-letter words *)
(* Obtain all tetragrams for each word *)
(* The above produces a list of lists, so flatten at the first level to make counting easier *)
tetragrams = Flatten[Subsequences[#, {4}]& /@ Select[Characters[text], Length[#]>3&], 1]


(* Count the frequency of each tetragram, divided by the total number of tetragrams *)
tetraFreqAll = KeySort[Map[#/Length[tetragrams]&, Counts[tetragrams]]];
(* Keep only tetragrams containing strictly alphabetical characters *)
tetraFreqAlpha = KeySelect[tetraFreqAll, !MemberQ[LetterNumber[#], 0]&];


(* Keep the 25 most frequent tetragrams and graph on a bar chart *)
top25tetra = Take[Sort[tetraFreqAlpha, Greater], 25]
BarChart[top25tetra, ChartLabels -> Placed[StringJoin /@ Keys[top25tetra], Below, Rotate[#, 60 Degree]&]]


(* Compress the monograms, bigrams, trigrams, and tetragrams and export as plaintext *)
Export[FileNameJoin[NotebookDirectory[], "monoFreqAlpha.txt"], Compress[monoFreqAlpha]];
Export[FileNameJoin[NotebookDirectory[], "biFreqAlpha.txt"], Compress[biFreqAlpha]];
Export[FileNameJoin[NotebookDirectory[], "triFreqAlpha.txt"], Compress[triFreqAlpha]];
Export[FileNameJoin[NotebookDirectory[], "tetraFreqAlpha.txt"], Compress[tetraFreqAlpha]];
